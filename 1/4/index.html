<!DOCTYPE html><html lang="en" class="h-full"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://cdn.math.computer/i/1/ss-makefile-vfx.jpg" fetchPriority="high"/><link rel="stylesheet" href="/2025/_next/static/css/df8c932e539912be.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/2025/_next/static/chunks/webpack-b2ce682491b35475.js"/><script src="/2025/_next/static/chunks/fd9d1056-a86d52f6b747304e.js" async=""></script><script src="/2025/_next/static/chunks/117-003a6b1a715a95e6.js" async=""></script><script src="/2025/_next/static/chunks/main-app-3c13ae280b9991a1.js" async=""></script><script src="/2025/_next/static/chunks/app/layout-c0991f7d76273a13.js" async=""></script><script src="/2025/_next/static/chunks/450-fc8431448c3438bc.js" async=""></script><script src="/2025/_next/static/chunks/878-5d3156bd3161bc5d.js" async=""></script><script src="/2025/_next/static/chunks/app/%5Bmonth%5D/%5Bday%5D/page-475f15d3cd396c50.js" async=""></script><title>MathematicalMichaelx2025</title><meta name="description" content="Digital Art Log for Dr. Michael Pilosov"/><link rel="icon" href="/2025/favicon.ico" type="image/x-icon" sizes="48x48"/><script src="/2025/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="min-h-full bg-white dark:bg-black"><script>((e,t,r,n,l,o,a,u)=>{let i=document.documentElement,c=["light","dark"];function d(t){(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&o?l.map(e=>o[e]||e):l;r?(i.classList.remove(...n),i.classList.add(t)):i.setAttribute(e,t)}),u&&c.includes(t)&&(i.style.colorScheme=t)}if(n)d(n);else try{let e=localStorage.getItem(t)||r,n=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;d(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="flex flex-col min-h-full"><div class="flex-1 w-full"><div class="min-h-screen bg-white dark:bg-black text-black dark:text-white"><header class="flex justify-between items-center mb-8 px-4"><a class="text-2xl font-bold hover:underline" href="/2025/">2025 (12 Events)</a><div class="flex items-center"><a class="hover:underline mr-4" href="/2025/about/">About</a><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:text-accent-foreground h-9 hover:bg-transparent p-0" disabled=""><div class="h-5 w-5"></div><span class="sr-only">Loading theme toggle</span></button></div></header><nav class="flex justify-between w-full mb-8 text-3xl font-bold text-gray-600 dark:text-gray-400 px-4"><div class="flex-1 flex justify-start"><a class="hover:underline" href="/2025/1/3/">←</a></div><div class="flex-1 flex justify-end"><a class="hover:underline" href="/2025/1/5/">→</a></div></nav><main><div class="max-w-content mx-auto px-4"><article><h1 class="text-3xl font-bold mb-2">My Love of GNU Make</h1><p class="text-gray-600 dark:text-gray-400 mb-4">2025-01-04</p><div class="prose dark:prose-invert mb-8 [&amp;&gt;p]:mb-4 [&amp;_a]:underline [&amp;_a:hover]:text-gray-600 dark:[&amp;_a:hover]:text-gray-300 [&amp;&gt;ul]:list-disc [&amp;&gt;ul]:pl-6 [&amp;&gt;ul]:mb-4 [&amp;&gt;ul&gt;li]:pl-2"><p>As I was preparing my posts, I found myself really appreciating one of the tools I rely on: <a href="https://www.gnu.org/software/make/">GNU Make</a>.</p>
<p>I don’t use this for its “intended” use-case for compiling C programs (except when necessary), but I do take advantage of the simple manner it which it works (comparing timestamps in files to determine if something needs to be re-created), in order to automate many of my workflows.</p>
<p>For example, I do not commit images or other large data files to repositories, but do want to make it extremely easy to reproduce my results.
Be it for sharing with others, or just for myself when I switch between remote and local machines, getting data to disk should not require copy/pasting commands from a README.</p>
<p>Take for example - the sample video from <a href="/1/1/">the first day’s post</a>.
In order to accomplish this process I must:</p>
<ol>
<li>Download a video</li>
<li>Split this video into frames (creating a <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">frames/</code> directory if one does not exist)</li>
<li>Process each frame in the video, handling all dependencies required to do so, writing results to an output directory (again, creating folders as necessary).</li>
<li>Stitch the output frames back together into a video.</li>
</ol>
<p>Admittedly, I am a recovering addict of premature automation - so these days I try to automate things gradually, as needed.</p>
<blockquote>
<p>As an explicit example, you’ll notice that at the time of writing, the code blocks shown have some filenames hard-coded as opposed to being configurable from the command-line.</p>
</blockquote>
<p>For me, editing a line in a Makefile is not enough friction to bother with automation, but I do want to be efficient in how I approach things. For instance:</p>
<ul>
<li>Do not download a file that already exists</li>
<li>Do not run scripts that have not changed</li>
<li>Minimize the number of keystrokes it takes me to run experiments</li>
</ul>
<p>To this end, here are three of the relevant pieces of code, unedited:</p>
<div class="mb-4"><div class="bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono"><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.75rem"><code class="language-makefile" style="white-space:pre;background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token target" style="color:hsl(355, 65%, 65%)">input.mp4</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">	curl -fsSL https</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>//cdn.math.computer/v/kosmos2/fish/sm/input.mp4 -o input.mp4
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">split</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> input.mp4
</span></span><span>	mkdir -p frames
</span><span><span>	</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># ffmpeg -i input.mp4 -vf &quot;fps=30&quot; frames/frame_%06d.png</span><span>
</span></span><span><span>	ffmpeg -i input.mp4 -vf </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;fps=30,scale=&#x27;min(iw/3,iw):min(ih/3,ih)&#x27;&quot;</span><span> frames/frame_%06d.png
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">stitch</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span></span><span><span>	ffmpeg -framerate 30 -i </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;out/frame_%06d.png&#x27;</span><span class="token target" style="color:hsl(355, 65%, 65%)"> -c</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>v libx264 -crf 23 -pix_fmt yuv420p output.mp4
</span></span><span>
</span><span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># Note: the contents of out/ are generated by another makefile target not shown here.</span><span>
</span></span><span></span></code></pre></div></div>
<p>Now if <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">input.mp4</code> is not present, it will automatically be downloaded because of the dependency encoded in the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">split</code> target.
Right now that <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">split</code> target is what’s called a “phony” target, which means it does not actually generate any files.
Rather, the syntax shown above simply ensures that the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">input.mp4</code> file exists before running the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">ffmpeg</code> command, reducing the count of things for me to remember by one.</p>
<p>This is how I first started using Makefiles, but their true power comes from having real target definitions that do generate files. More on this in a second.</p>
<p>Notice the commented out line for opting out of resizing - I haven’t bothered to automate the scaling factor because I’ve mostly run tests against proxy images (downscaled).
When it comes to recognizing content in images, this resolution of 1/3 is a good balance of speed and quality (going smaller does not improve model inference time by much), so I’ve had it fixed there for a while.</p>
<p>To automate such a scaling factor would look like this:</p>
<div class="mb-4"><div class="bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono"><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.75rem"><code class="language-makefile" style="white-space:pre;background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>scale</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>3
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">split</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span></span><span>	mkdir -p frames
</span><span><span>	ffmpeg -i input.mp4 -vf </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;fps=30,scale=&#x27;min(iw/$(scale),iw):min(ih/$(scale),ih)&#x27;&quot;</span><span> frames/frame_%06d.png
</span></span><span></span></code></pre></div></div>
<p>With invocation <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make scale=1 split</code> or <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make split scale=1</code>, I can now run <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make split</code> as before so it defaults to my 1/3 scale (while giving myself the option of <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">scale=1</code> for no scaling), removing the need for the commented out line.
This is what I mean by my attempts at piecemeal automation - I can improve things incrementally, as needed, without having to do everything at once.</p>
<h2>Real Targets</h2>
<p>Consider the process of a docker build where dependencies are encoded in <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">pyproject.toml</code>, but the (frozen) requirements file for the docker build is generated based on this file.</p>
<p>Below, the need to ensure that the build requirements are up-to-date before building the docker image is handled by the relationship between the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">build</code> target depending on <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">requirements.api.txt</code>, and the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">requirements.api.txt</code> target depending on <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">pyproject.toml</code>:</p>
<div class="mb-4"><div class="bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono"><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.75rem"><code class="language-makefile" style="white-space:pre;background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token target" style="color:hsl(355, 65%, 65%)">requirements.api.txt</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> pyproject.toml
</span></span><span>	uv pip compile pyproject.toml --extra api -o requirements.api.txt
</span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">build</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> requirements.api.txt
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">	docker build -t kosmos2-api</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>latest .
</span></span><span></span></code></pre></div></div>
<p>If a change is made to <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">pyproject.toml</code>, the <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">requirements.api.txt</code> target will be re-run, and the docker image will have the correct dependencies, every time.</p>
<p>Committing <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">requirements.api.txt</code> to the repository is still a good idea for tracking changes, but the small amount of syntax in the Makefile ensures I don’t need to remember to do this myself.</p>
<h2>Doing It Properly</h2>
<p>Here is what the Makefile looks like after doing it “the right way”:</p>
<div class="mb-4"><div class="bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono"><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.75rem"><code class="language-makefile" style="white-space:pre;background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token target" style="color:hsl(355, 65%, 65%)">orig.mov</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">	curl -fsSL https</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>//cdn.math.computer/v/kosmos2/fish/IMG_2867.MOV -o orig.mov
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">input.mp4</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> frames/frame_000001.png
</span></span><span><span>	ffmpeg -framerate 30 -i </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;frames/frame_%06d.png&#x27;</span><span class="token target" style="color:hsl(355, 65%, 65%)"> -c</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>v libx264 -crf 23 -pix_fmt yuv420p input.mp4
</span></span><span><span>	</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># curl -fsSL https://cdn.math.computer/v/kosmos2/fish/sm/input.mp4 -o input.mp4</span><span>
</span></span><span>
</span><span><span>scale</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>3
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">frames/frame_000001.png</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> orig.mov
</span></span><span>	mkdir -p frames
</span><span><span>	ffmpeg -i orig.mov -vf </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;fps=30,scale=&#x27;min(iw/$(scale),iw):min(ih/$(scale),ih)&#x27;&quot;</span><span> frames/frame_%06d.png
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">out/frame_000001.png</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> client.py frames/frame_000001.png
</span></span><span>	uv run --isolated --extra viz --with ray client.py
</span><span>
</span><span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic"># aliases for convenience:</span><span>
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">output.mp4</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> out/frame_000001.png
</span></span><span><span>	ffmpeg -framerate 30 -i </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;out/frame_%06d.png&#x27;</span><span class="token target" style="color:hsl(355, 65%, 65%)"> -c</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>v libx264 -crf 23 -pix_fmt yuv420p output.mp4
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">split</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> frames/frame_000001.png
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">stitch</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> output.mp4
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">movie</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> out/frame_000001.png
</span></span><span></span></code></pre></div></div>
<p>With these edits, I take a step towards proper caching.
The input and output videos are defined as targets, and one of the frames is used as an indicator that the process that generated them has completed.</p>
<p>However, <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">split</code> has no way of knowing what the scale factor was, so I need to remove the first input frame file in order to force it to re-run.</p>
<p>To do this properly, I would do something like this:</p>
<div class="mb-4"><div class="bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono"><pre style="background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.75rem"><code class="language-makefile" style="white-space:pre;background:transparent;color:hsl(220, 14%, 71%);text-shadow:none;font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>scale</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>3
</span></span><span><span>file</span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>fish.mov
</span></span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">frames/frame_000001.png</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>file</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span></span><span><span>	ffmpeg -i </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>file</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> -vf </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;fps=30,scale=&#x27;min(iw/$(scale),iw):min(ih/$(scale),ih)&#x27;&quot;</span><span> frames/frame_%06d.png
</span></span><span><span>	</span><span class="token" style="color:hsl(207, 82%, 66%)">@</span><span>du -sh frames
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">out/frame_000001.png</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> client.py bboxes.py frames/frame_000001.png
</span></span><span>	rm -rf out &amp;&amp; mkdir -p out
</span><span>	uv run --isolated --extra viz --with ray client.py
</span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">output.mp4</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> out/frame_000001.png
</span></span><span><span>	ffmpeg -framerate 30 -i </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;out/frame_%06d.png&#x27;</span><span class="token target" style="color:hsl(355, 65%, 65%)"> -c</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>v libx264 -crf 23 -pix_fmt yuv420p output.mp4
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">split</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> frames/frame_000001.png
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">stitch</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> output.mp4
</span></span><span>
</span><span><span></span><span class="token target" style="color:hsl(355, 65%, 65%)">movie</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> output.mp4
</span></span><span></span></code></pre></div></div>
<h2>Final Thoughts</h2>
<p>I suppose this post turned into a documentation of my general process for dealing with image processing pipelines, especially when it’s just for my art projects.
The primary beneficiary of my use of Makefile is my future self.
By writing the commands down and their inputs / output dependencies, I am able to pick up where I left off when I revisit my many scattered experiments.</p>
<p>I credit my first manager with introducing me to <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make</code> / Makefile on a project where he just used them as a collection of shell scripts in one file, a convenient self-documenting resource for the project.</p>
<p>Over the years, I’ve gradually improved my understanding of how to use them for Machine Learning automation.
In my art repositories, I use Makefiles to encode the command-line invocations required to generate each of the images I create.
Since my pieces involve many steps, having <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make</code> handle caching for me based on simple comparisons of timestamps (which is how <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make</code> works), is an easy hack.</p>
<p>I will often dump ten or fifteen lines of commands there to capture various combinations of running a script, and clean it up later once I have a result I like.
In this way, they serve as a scratch-pad for my thoughts, and a convenient way to make my art, which is usually command-line based instead of UI/GUI.</p>
<p>In conclusion, I think <code class="bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm">make</code> is just great, and I enjoy using it for non-compiled projects.</p>
</div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><figure class="flex flex-col items-center"><div class="relative overflow-hidden"><img alt="ss-makefile-vfx.jpg" fetchPriority="high" loading="eager" width="614" height="501" decoding="async" data-nimg="1" class="w-max-full" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 614 501&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/svg+xml;base64,Cjxzdmcgd2lkdGg9IjcwMCIgaGVpZ2h0PSI0NzUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImciPgogICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDAwMCIgb2Zmc2V0PSIyMCUiIC8+CiAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwMDAxIiBvZmZzZXQ9IjUwJSIgLz4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzAwMDAiIG9mZnNldD0iNzAlIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSI0NzUiIGZpbGw9IiMwMDAwIiAvPgogIDxyZWN0IGlkPSJyIiB3aWR0aD0iNzAwIiBoZWlnaHQ9IjQ3NSIgZmlsbD0idXJsKCNnKSIgLz4KICA8YW5pbWF0ZSB4bGluazpocmVmPSIjciIgYXR0cmlidXRlTmFtZT0ieCIgZnJvbT0iLTcwMCIgdG89IjcwMCIgZHVyPSIxcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiICAvPgo8L3N2Zz4=&#x27;/%3E%3C/svg%3E&quot;)" src="https://cdn.math.computer/i/1/ss-makefile-vfx.jpg"/></div><figcaption class="mt-2 text-center text-sm text-gray-600 dark:text-gray-400">A real example from a makefile in my art repository, stripped out data from an SVG to make it compatible with my pen-plotter</figcaption></figure></div></article></div></main><nav class="flex justify-between w-full mt-8 mb-4 text-3xl font-bold text-gray-600 dark:text-gray-400 px-4"><div class="flex-1 flex justify-start"><a class="hover:underline" href="/2025/1/3/">←</a></div><div class="flex-1 flex justify-end"><a class="hover:underline" href="/2025/1/5/">→</a></div></nav></div></div><footer class="text-center text-sm text-gray-600 dark:text-gray-400 py-4 bg-white dark:bg-black">© <!-- -->2025<!-- --> Michael Pilosov. All rights reserved.</footer></div><script src="/2025/_next/static/chunks/webpack-b2ce682491b35475.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/2025/_next/static/css/df8c932e539912be.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[2846,[],\"\"]\n5:I[4707,[],\"\"]\n8:I[6423,[],\"\"]\n9:I[2798,[\"185\",\"static/chunks/app/layout-c0991f7d76273a13.js\"],\"ThemeProvider\"]\na:I[9734,[\"185\",\"static/chunks/app/layout-c0991f7d76273a13.js\"],\"DynamicFavicon\"]\nb:I[8291,[\"185\",\"static/chunks/app/layout-c0991f7d76273a13.js\"],\"Analytics\"]\nd:I[1060,[],\"\"]\n6:[\"month\",\"1\",\"d\"]\n7:[\"day\",\"4\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L2\",null,{\"buildId\":\"VQoYmXv-G56ZgJRRzJJFi\",\"assetPrefix\":\"/2025\",\"urlParts\":[\"\",\"1\",\"4\",\"\"],\"initialTree\":[\"\",{\"children\":[[\"month\",\"1\",\"d\"],{\"children\":[[\"day\",\"4\",\"d\"],{\"children\":[\"__PAGE__?{\\\"month\\\":\\\"1\\\",\\\"day\\\":\\\"4\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"month\",\"1\",\"d\"],{\"children\":[[\"day\",\"4\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\",null],null],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$6\",\"children\",\"$7\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$6\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/2025/_next/static/css/df8c932e539912be.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"className\":\"h-full\",\"children\":[\"$\",\"body\",null,{\"className\":\"min-h-full bg-white dark:bg-black\",\"children\":[[\"$\",\"$L9\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col min-h-full\",\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"div\",null,{\"className\":\"flex-1 w-full\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"text-center text-sm text-gray-600 dark:text-gray-400 py-4 bg-white dark:bg-black\",\"children\":[\"© \",2025,\" Michael Pilosov. All rights reserved.\"]}]]}]}],[\"$\",\"$Lb\",null,{}]]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]\n"])</script><script>self.__next_f.push([1,"f:I[2972,[\"450\",\"static/chunks/450-fc8431448c3438bc.js\",\"878\",\"static/chunks/878-5d3156bd3161bc5d.js\",\"160\",\"static/chunks/app/%5Bmonth%5D/%5Bday%5D/page-475f15d3cd396c50.js\"],\"\"]\n10:I[1190,[\"450\",\"static/chunks/450-fc8431448c3438bc.js\",\"878\",\"static/chunks/878-5d3156bd3161bc5d.js\",\"160\",\"static/chunks/app/%5Bmonth%5D/%5Bday%5D/page-475f15d3cd396c50.js\"],\"ThemeToggle\"]\n11:I[5878,[\"450\",\"static/chunks/450-fc8431448c3438bc.js\",\"878\",\"static/chunks/878-5d3156bd3161bc5d.js\",\"160\",\"static/chunks/app/%5Bmonth%5D/%5Bday%5D/page-475f15d3cd396c50.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-white dark:bg-black text-black dark:text-white\",\"children\":[[\"$\",\"header\",null,{\"className\":\"flex justify-between items-center mb-8 px-4\",\"children\":[[\"$\",\"$Lf\",null,{\"href\":\"/\",\"className\":\"text-2xl font-bold hover:underline\",\"children\":\"2025 (12 Events)\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"$Lf\",null,{\"href\":\"/about\",\"className\":\"hover:underline mr-4\",\"children\":\"About\"}],[\"$\",\"$L10\",null,{}]]}]]}],[\"$\",\"nav\",null,{\"className\":\"flex justify-between w-full mb-8 text-3xl font-bold text-gray-600 dark:text-gray-400 px-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex-1 flex justify-start\",\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/1/3\",\"className\":\"hover:underline\",\"children\":\"←\"}]}],[\"$\",\"div\",null,{\"className\":\"flex-1 flex justify-end\",\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/1/5\",\"className\":\"hover:underline\",\"children\":\"→\"}]}]]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-content mx-auto px-4\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":\"My Love of GNU Make\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-600 dark:text-gray-400 mb-4\",\"children\":\"2025-01-04\"}],[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert mb-8 [\u0026\u003ep]:mb-4 [\u0026_a]:underline [\u0026_a:hover]:text-gray-600 dark:[\u0026_a:hover]:text-gray-300 [\u0026\u003eul]:list-disc [\u0026\u003eul]:pl-6 [\u0026\u003eul]:mb-4 [\u0026\u003eul\u003eli]:pl-2\",\"children\":[[\"$\",\"p\",\"0\",{\"children\":[\"As I was preparing my posts, I found myself really appreciating one of the tools I rely on: \",[\"$\",\"a\",\"1\",{\"href\":\"https://www.gnu.org/software/make/\",\"children\":\"GNU Make\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"2\",{\"children\":\"I don’t use this for its “intended” use-case for compiling C programs (except when necessary), but I do take advantage of the simple manner it which it works (comparing timestamps in files to determine if something needs to be re-created), in order to automate many of my workflows.\"}],\"\\n\",[\"$\",\"p\",\"4\",{\"children\":\"For example, I do not commit images or other large data files to repositories, but do want to make it extremely easy to reproduce my results.\\nBe it for sharing with others, or just for myself when I switch between remote and local machines, getting data to disk should not require copy/pasting commands from a README.\"}],\"\\n\",[\"$\",\"p\",\"6\",{\"children\":[\"Take for example - the sample video from \",[\"$\",\"a\",\"1\",{\"href\":\"/1/1/\",\"children\":\"the first day’s post\"}],\".\\nIn order to accomplish this process I must:\"]}],\"\\n\",[\"$\",\"ol\",\"8\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":\"Download a video\"}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":[\"Split this video into frames (creating a \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"frames/\"}],\" directory if one does not exist)\"]}],\"\\n\",[\"$\",\"li\",\"5\",{\"children\":\"Process each frame in the video, handling all dependencies required to do so, writing results to an output directory (again, creating folders as necessary).\"}],\"\\n\",[\"$\",\"li\",\"7\",{\"children\":\"Stitch the output frames back together into a video.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"10\",{\"children\":\"Admittedly, I am a recovering addict of premature automation - so these days I try to automate things gradually, as needed.\"}],\"\\n\",[\"$\",\"blockquote\",\"12\",{\"children\":[\"\\n\",[\"$\",\"p\",\"1\",{\"children\":\"As an explicit example, you’ll notice that at the time of writing, the code blocks shown have some filenames hard-coded as opposed to being configurable from the command-line.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"14\",{\"children\":\"For me, editing a line in a Makefile is not enough friction to bother with automation, but I do want to be efficient in how I approach things. For instance:\"}],\"\\n\",[\"$\",\"ul\",\"16\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":\"Do not download a file that already exists\"}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":\"Do not run scripts that have not changed\"}],\"\\n\",[\"$\",\"li\",\"5\",{\"children\":\"Minimize the number of keystrokes it takes me to run experiments\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"18\",{\"children\":\"To this end, here are three of the relevant pieces of code, unedited:\"}],\"\\n\",[\"$\",\"div\",\"20\",{\"className\":\"mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1rem\",\"margin\":0,\"overflow\":\"auto\",\"borderRadius\":\"0.3em\",\"fontSize\":\"0.75rem\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-makefile\",\"style\":{\"whiteSpace\":\"pre\",\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"input.mp4\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"\\tcurl -fsSL https\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"//cdn.math.computer/v/kosmos2/fish/sm/input.mp4 -o input.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"split\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" input.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tmkdir -p frames\\n\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\t\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 10%, 40%)\",\"fontStyle\":\"italic\"},\"children\":[\"# ffmpeg -i input.mp4 -vf \\\"fps=30\\\" frames/frame_%06d.png\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -i input.mp4 -vf \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"\\\"fps=30,scale='min(iw/3,iw):min(ih/3,ih)'\\\"\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_%06d.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"stitch\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -framerate 30 -i \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"'out/frame_%06d.png'\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\" -c\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"v libx264 -crf 23 -pix_fmt yuv420p output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 10%, 40%)\",\"fontStyle\":\"italic\"},\"children\":[\"# Note: the contents of out/ are generated by another makefile target not shown here.\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]]]}]}]}]}],\"\\n\",[\"$\",\"p\",\"22\",{\"children\":[\"Now if \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"input.mp4\"}],\" is not present, it will automatically be downloaded because of the dependency encoded in the \",[\"$\",\"code\",\"3\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"split\"}],\" target.\\nRight now that \",[\"$\",\"code\",\"5\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"split\"}],\" target is what’s called a “phony” target, which means it does not actually generate any files.\\nRather, the syntax shown above simply ensures that the \",[\"$\",\"code\",\"7\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"input.mp4\"}],\" file exists before running the \",[\"$\",\"code\",\"9\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"ffmpeg\"}],\" command, reducing the count of things for me to remember by one.\"]}],\"\\n\",[\"$\",\"p\",\"24\",{\"children\":\"This is how I first started using Makefiles, but their true power comes from having real target definitions that do generate files. More on this in a second.\"}],\"\\n\",[\"$\",\"p\",\"26\",{\"children\":\"Notice the commented out line for opting out of resizing - I haven’t bothered to automate the scaling factor because I’ve mostly run tests against proxy images (downscaled).\\nWhen it comes to recognizing content in images, this resolution of 1/3 is a good balance of speed and quality (going smaller does not improve model inference time by much), so I’ve had it fixed there for a while.\"}],\"\\n\",[\"$\",\"p\",\"28\",{\"children\":\"To automate such a scaling factor would look like this:\"}],\"\\n\",[\"$\",\"div\",\"30\",{\"className\":\"mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1rem\",\"margin\":0,\"overflow\":\"auto\",\"borderRadius\":\"0.3em\",\"fontSize\":\"0.75rem\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-makefile\",\"style\":{\"whiteSpace\":\"pre\",\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"scale\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"3\\n\"]}]]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"split\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tmkdir -p frames\\n\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -i input.mp4 -vf \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"\\\"fps=30,scale='min(iw/$(scale),iw):min(ih/$(scale),ih)'\\\"\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_%06d.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]]]}]}]}]}],\"\\n\",[\"$\",\"p\",\"32\",{\"children\":[\"With invocation \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make scale=1 split\"}],\" or \",[\"$\",\"code\",\"3\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make split scale=1\"}],\", I can now run \",[\"$\",\"code\",\"5\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make split\"}],\" as before so it defaults to my 1/3 scale (while giving myself the option of \",[\"$\",\"code\",\"7\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"scale=1\"}],\" for no scaling), removing the need for the commented out line.\\nThis is what I mean by my attempts at piecemeal automation - I can improve things incrementally, as needed, without having to do everything at once.\"]}],\"\\n\",[\"$\",\"h2\",\"34\",{\"children\":\"Real Targets\"}],\"\\n\",[\"$\",\"p\",\"36\",{\"children\":[\"Consider the process of a docker build where dependencies are encoded in \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"pyproject.toml\"}],\", but the (frozen) requirements file for the docker build is generated based on this file.\"]}],\"\\n\",[\"$\",\"p\",\"38\",{\"children\":[\"Below, the need to ensure that the build requirements are up-to-date before building the docker image is handled by the relationship between the \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"build\"}],\" target depending on \",[\"$\",\"code\",\"3\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"requirements.api.txt\"}],\", and the \",[\"$\",\"code\",\"5\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"requirements.api.txt\"}],\" target depending on \",[\"$\",\"code\",\"7\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"pyproject.toml\"}],\":\"]}],\"\\n\",[\"$\",\"div\",\"40\",{\"className\":\"mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1rem\",\"margin\":0,\"overflow\":\"auto\",\"borderRadius\":\"0.3em\",\"fontSize\":\"0.75rem\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-makefile\",\"style\":{\"whiteSpace\":\"pre\",\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"requirements.api.txt\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pyproject.toml\\n\"]}]]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tuv pip compile pyproject.toml --extra api -o requirements.api.txt\\n\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"build\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" requirements.api.txt\\n\"]}]]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"\\tdocker build -t kosmos2-api\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"latest .\\n\"]}]]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]]]}]}]}]}],\"\\n\",[\"$\",\"p\",\"42\",{\"children\":[\"If a change is made to \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"pyproject.toml\"}],\", the \",[\"$\",\"code\",\"3\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"requirements.api.txt\"}],\" target will be re-run, and the docker image will have the correct dependencies, every time.\"]}],\"\\n\",[\"$\",\"p\",\"44\",{\"children\":[\"Committing \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"requirements.api.txt\"}],\" to the repository is still a good idea for tracking changes, but the small amount of syntax in the Makefile ensures I don’t need to remember to do this myself.\"]}],\"\\n\",[\"$\",\"h2\",\"46\",{\"children\":\"Doing It Properly\"}],\"\\n\",[\"$\",\"p\",\"48\",{\"children\":\"Here is what the Makefile looks like after doing it “the right way”:\"}],\"\\n\",[\"$\",\"div\",\"50\",{\"className\":\"mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1rem\",\"margin\":0,\"overflow\":\"auto\",\"borderRadius\":\"0.3em\",\"fontSize\":\"0.75rem\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-makefile\",\"style\":{\"whiteSpace\":\"pre\",\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"orig.mov\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"\\tcurl -fsSL https\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"//cdn.math.computer/v/kosmos2/fish/IMG_2867.MOV -o orig.mov\\n\"]}]]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"input.mp4\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -framerate 30 -i \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"'frames/frame_%06d.png'\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\" -c\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"v libx264 -crf 23 -pix_fmt yuv420p input.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\t\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 10%, 40%)\",\"fontStyle\":\"italic\"},\"children\":[\"# curl -fsSL https://cdn.math.computer/v/kosmos2/fish/sm/input.mp4 -o input.mp4\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"scale\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"3\\n\"]}]]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"frames/frame_000001.png\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" orig.mov\\n\"]}]]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tmkdir -p frames\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -i orig.mov -vf \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"\\\"fps=30,scale='min(iw/$(scale),iw):min(ih/$(scale),ih)'\\\"\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_%06d.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"out/frame_000001.png\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" client.py frames/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tuv run --isolated --extra viz --with ray client.py\\n\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 10%, 40%)\",\"fontStyle\":\"italic\"},\"children\":[\"# aliases for convenience:\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"output.mp4\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" out/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -framerate 30 -i \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"'out/frame_%06d.png'\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\" -c\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"v libx264 -crf 23 -pix_fmt yuv420p output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"split\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"stitch\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"movie\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" out/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]]]}]}]}]}],\"\\n\",[\"$\",\"p\",\"52\",{\"children\":\"With these edits, I take a step towards proper caching.\\nThe input and output videos are defined as targets, and one of the frames is used as an indicator that the process that generated them has completed.\"}],\"\\n\",[\"$\",\"p\",\"54\",{\"children\":[\"However, \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"split\"}],\" has no way of knowing what the scale factor was, so I need to remove the first input frame file in order to force it to re-run.\"]}],\"\\n\",[\"$\",\"p\",\"56\",{\"children\":\"To do this properly, I would do something like this:\"}],\"\\n\",[\"$\",\"div\",\"58\",{\"className\":\"mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"bg-neutral-100 dark:bg-neutral-800 rounded-md font-mono\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1rem\",\"margin\":0,\"overflow\":\"auto\",\"borderRadius\":\"0.3em\",\"fontSize\":\"0.75rem\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-makefile\",\"style\":{\"whiteSpace\":\"pre\",\"background\":\"transparent\",\"color\":\"hsl(220, 14%, 71%)\",\"textShadow\":\"none\",\"fontFamily\":\"\\\"Fira Code\\\", \\\"Fira Mono\\\", Menlo, Consolas, \\\"DejaVu Sans Mono\\\", monospace\",\"direction\":\"ltr\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"2\",\"OTabSize\":\"2\",\"tabSize\":\"2\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"scale\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"3\\n\"]}]]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"fish.mov\\n\"]}]]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"frames/frame_000001.png\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"$$\"]}],[\"$\",\"span\",\"code-segment-1-5\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-1-6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file\"]}],[\"$\",\"span\",\"code-segment-1-7\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-1-8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}]]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -i \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"$$\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file\"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segment-1-5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" -vf \"]}],[\"$\",\"span\",\"code-segment-1-6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"\\\"fps=30,scale='min(iw/$(scale),iw):min(ih/$(scale),ih)'\\\"\"]}],[\"$\",\"span\",\"code-segment-1-7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_%06d.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\t\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(207, 82%, 66%)\"},\"children\":[\"@\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"du -sh frames\\n\"]}]]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"out/frame_000001.png\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" client.py bboxes.py frames/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\trm -rf out \u0026\u0026 mkdir -p out\\n\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tuv run --isolated --extra viz --with ray client.py\\n\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"output.mp4\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" out/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tffmpeg -framerate 30 -i \"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(95, 38%, 62%)\"},\"children\":[\"'out/frame_%06d.png'\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\" -c\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"v libx264 -crf 23 -pix_fmt yuv420p output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"split\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" frames/frame_000001.png\\n\"]}]]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"stitch\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[[\"$\",\"span\",\"code-segment-1-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segment-1-1\",{\"className\":\"token target\",\"style\":{\"color\":\"hsl(355, 65%, 65%)\"},\"children\":[\"movie\"]}],[\"$\",\"span\",\"code-segment-1-2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(220, 14%, 71%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segment-1-3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output.mp4\\n\"]}]]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}]]]}]}]}]}],\"\\n\",[\"$\",\"h2\",\"60\",{\"children\":\"Final Thoughts\"}],\"\\n\",[\"$\",\"p\",\"62\",{\"children\":\"I suppose this post turned into a documentation of my general process for dealing with image processing pipelines, especially when it’s just for my art projects.\\nThe primary beneficiary of my use of Makefile is my future self.\\nBy writing the commands down and their inputs / output dependencies, I am able to pick up where I left off when I revisit my many scattered experiments.\"}],\"\\n\",[\"$\",\"p\",\"64\",{\"children\":[\"I credit my first manager with introducing me to \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make\"}],\" / Makefile on a project where he just used them as a collection of shell scripts in one file, a convenient self-documenting resource for the project.\"]}],\"\\n\",[\"$\",\"p\",\"66\",{\"children\":[\"Over the years, I’ve gradually improved my understanding of how to use them for Machine Learning automation.\\nIn my art repositories, I use Makefiles to encode the command-line invocations required to generate each of the images I create.\\nSince my pieces involve many steps, having \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make\"}],\" handle caching for me based on simple comparisons of timestamps (which is how \",[\"$\",\"code\",\"3\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make\"}],\" works), is an easy hack.\"]}],\"\\n\",[\"$\",\"p\",\"68\",{\"children\":\"I will often dump ten or fifteen lines of commands there to capture various combinations of running a script, and clean it up later once I have a result I like.\\nIn this way, they serve as a scratch-pad for my thoughts, and a convenient way to make my art, which is usually command-line based instead of UI/GUI.\"}],\"\\n\",[\"$\",\"p\",\"70\",{\"children\":[\"In conclusion, I think \",[\"$\",\"code\",\"1\",{\"className\":\"bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded text-sm\",\"children\":\"make\"}],\" is just great, and I enjoy using it for non-compiled projects.\"]}],\"\\n\"]}],[\"$\",\"div\",null,{\"className\":\"grid grid-cols-1 md:grid-cols-2 gap-4\",\"children\":[[\"$\",\"figure\",\"0\",{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"relative overflow-hidden\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"https://cdn.math.computer/i/1/ss-makefile-vfx.jpg\",\"alt\":\"ss-makefile-vfx.jpg\",\"width\":614,\"height\":501,\"className\":\"w-max-full\",\"sizes\":\"614px\",\"quality\":78,\"priority\":true,\"loading\":\"eager\",\"placeholder\":\"blur\",\"blurDataURL\":\"data:image/svg+xml;base64,Cjxzdmcgd2lkdGg9IjcwMCIgaGVpZ2h0PSI0NzUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImciPgogICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDAwMCIgb2Zmc2V0PSIyMCUiIC8+CiAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwMDAxIiBvZmZzZXQ9IjUwJSIgLz4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzAwMDAiIG9mZnNldD0iNzAlIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSI0NzUiIGZpbGw9IiMwMDAwIiAvPgogIDxyZWN0IGlkPSJyIiB3aWR0aD0iNzAwIiBoZWlnaHQ9IjQ3NSIgZmlsbD0idXJsKCNnKSIgLz4KICA8YW5pbWF0ZSB4bGluazpocmVmPSIjciIgYXR0cmlidXRlTmFtZT0ieCIgZnJvbT0iLTcwMCIgdG89IjcwMCIgZHVyPSIxcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiICAvPgo8L3N2Zz4=\"}]}],[\"$\",\"figcaption\",null,{\"className\":\"mt-2 text-center text-sm text-gray-600 dark:text-gray-400\",\"dangerouslySetInnerHTML\":{\"__html\":\"A real example from a makefile in my art repository, stripped out data from an SVG to make it compatible with my pen-plotter\"}}]]}]]}]]}]}]}],[\"$\",\"nav\",null,{\"className\":\"flex justify-between w-full mt-8 mb-4 text-3xl font-bold text-gray-600 dark:text-gray-400 px-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex-1 flex justify-start\",\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/1/3\",\"className\":\"hover:underline\",\"children\":\"←\"}]}],[\"$\",\"div\",null,{\"className\":\"flex-1 flex justify-end\",\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/1/5\",\"className\":\"hover:underline\",\"children\":\"→\"}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"MathematicalMichaelx2025\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Digital Art Log for Dr. Michael Pilosov\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/2025/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}]]\n3:null\n"])</script></body></html>